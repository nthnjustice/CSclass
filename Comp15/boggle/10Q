Thank you to Alex Goldschmidt for his eagle-eye debugging skills and for 
helping me with the traversal algorithm. 
